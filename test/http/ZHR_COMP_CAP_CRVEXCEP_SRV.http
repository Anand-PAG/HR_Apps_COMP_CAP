@svc = http://localhost:4004/odata/v4/zhr-comp-cap-crvexcep-srv
@default_headers=Content-Type: application/json

## ZHR_COMP_CAP_CRVEXCEP_SRV
GET {{svc}}/$metadata

### ## THRSHLD Get
GET {{svc}}/BusinessDivisions

### Targettab get
GET {{svc}}/TargetTabs

### persona get
POST /odata/v4/zhr-comp-cap-crvexcep-srv/Persona
Content-Type: application/json

{ "user_email": "alice@example.com", "role": "approver" }


### Target Tabs Update
PUT {{svc}}/TargetTabs(ID='41fb91b9-4c2a-41f3-8b25-74d936abf711',year=2025,Modeltype='CRV',TargetTabName='Target1')
Content-Type: application/json

{
  "custBusUnit": "Business12",
  "custDivision": "Division12",
  "fieldUsage": "S"
}

### CRV Model Create
POST {{svc}}/postCRVModel
Content-Type: application/json

{
  "payload": {
    "TotalDistributed": "10000",
    "TotalDistributedPct": "9",
    "RemainingPool": "90000",
    "ModelId": "CM20250001",
    "year": "2025",
    "Targettab": "Target",
    "RemainingPoolPct": "9",
    "to_header": [
      {
        "option": "Option1",
        "performancesubzone": "6.1",
        "payzone": "6",
        "rating": "E/E",
        "budget": "5000",
        "total": "2500",
        "Indicator": "X",
        "sequence": "1",
        "to_item": [
          { "id": "", "text": "<80", "value": "100", "threshholdfrom": "0", "threshholdto": "79", "startrange": "0", "endrange": "79", "sequence": "1" }
        ]
      },
      {
        "option": "Option2",
        "performancesubzone": "6.2",
        "payzone": "6",
        "rating": "E/C+",
        "budget": "4000",
        "total": "2000",
        "Indicator": "Y",
        "sequence": "1",
        "to_item": []
      },
      {
        "option": "Option3",
        "performancesubzone": "4.1",
        "payzone": "4",
        "rating": "C/C+",
        "budget": "3000",
        "total": "1500",
        "Indicator": "Z",
        "sequence": "1",
        "to_item": []
      }
    ]
  }
}

### ## ZHR_COMP_CAP_CRVEXCEP_SRV Draft POST
POST {{svc}}/insertMultipleBusinessDivisions
Content-Type: application/json

{ 
  "entries": [
  { "year": 2025, "custBusUnit": "Transmission & Distribution", "custDivision": "NextGen", "fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Transmission & Distribution", "custDivision": "Veg, Inspection & Contractor Operations" , "fieldUsage": "S"},
  { "year": 2025, "custBusUnit": "Transmission & Distribution", "custDivision": "Veg, Inspection & Contractor Operations", "fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Transmission & Distribution", "custDivision": "Veg, Inspection & Contractor Operations" ,"fieldUsage": "S"},
  { "year": 2025, "custBusUnit": "Transmission & Distribution", "custDivision": "Veg, Inspection & Contractor Operations", "fieldUsage": "S" },
  
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services" ,"fieldUsage": "S"},
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services" ,"fieldUsage": "S"},
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Operational Services", "custDivision": "Transportation Services","fieldUsage": "S" },
  
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management" ,"fieldUsage": "S"},
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management","fieldUsage": "S" },
  { "year": 2025, "custBusUnit": "Energy Procurement & Management", "custDivision": "Energy Contract Management" ,"fieldUsage": "S"}
]

  
}

### ## ZHR_COMP_CAP_CRVEXCEP_SRV DELETE

DELETE {{svc}}/BusinessDivisions(ID='465d67d6-23bd-49c3-bb19-da757cbadf4a',year=2025)
Content-Type: application/json

{
    "year" : 2025,
    "custBusUnit" : "123",
    "custDivision":"213"
}

### insert Multipe values for Thresholds
POST {{svc}}/insertMultipleThresholds
Content-Type: application/json

{
  "entries": [
    {
      "year": 2024,
      "compaRatioRanges": "<80%",
      "startRange": "0",
      "endRange": "79",
      "sequence": "10",
      "fieldUsage": "S"
    },
    {
      "year": 2024,
      "compaRatioRanges": "80% - <90%",
      "startRange": "80",
      "endRange": "89",
      "sequence": "20",
      "fieldUsage": "S"
    }
  ]
}

### insert Multipe values for CompensationRatioMaster

POST {{svc}}/insertMultipleCompensationRatioMaster
Content-Type: application/json

{
  "entries": [
    {
       "year" : "2025",
        "performanceSubZone" : "6.1",
        "payzones"           : "6",
        "compaRatioRanges"   : "<80%",
        "startRange"         : "79",
        "endRange"           : null,
        "performanceRating"  : "E/E",
        "thresholdFrom"      : "4",
        "thresholdTo"        : "10",
        "status"             : "S"
    },
    {
       "year" : "2025",
        "performanceSubZone" : "6.1",
        "payzones"           : "6",
        "compaRatioRanges"   : "80% - <90%",
        "startRange"         : "80",
        "endRange"           : "89",
        "performanceRating"  : "E/E",
        "thresholdFrom"      : "3",
        "thresholdTo"        : "9",
        "status"             : "S"
    },
    {
       "year" : "2025",
        "performanceSubZone" : "6.1",
        "payzones"           : "6",
        "compaRatioRanges"   : "90% - <100%",
        "startRange"         : "90",
        "endRange"           : "99",
        "performanceRating"  : "E/E",
        "thresholdFrom"      : "4",
        "thresholdTo"        : "9",
        "status"             : "S"
    }
  ]
}

### insert Multipe values for Subzones

POST {{svc}}/insertMultipleSubzones
Content-Type: application/json

{
  "entries": [
    {
      "year": "2024",
      "performanceSubZone": "6.3",
      "sequence": "10",
      "fieldUsage": "S"
    }
    
  ]
}




### post TargetTabs
POST {{svc}}/TargetTabs
Content-Type: application/json

{
  "year": "2025",
  "Modeltype": "CRV",
  "TargetTabName": "Target2",
  "custBusUnit": "Bus1",
  "custDivision": "Div2",
  "fieldUsage": "S"
}

  
### POST CRVEXception
POST {{svc}}/insertMultipleCRVException
Content-Type: application/json

{
  "entries": [
    {
     "field_id": "ed3542de-331d-4406-a22b-15e13a8a2add",
      "custPERNR": "125338",
      "executiveRuleViolation": "S",
      "mgrFirstName": "Navniel",
      "mgrLastName": "Pillay",
      "userName": "Gabriella Loza",
      "custHireDate": "2021-09-27",
      "custBusUnit": "Customer Service",
      "custDivision": "Customer Service Operations Division",
      "custDepartment": "IDSM/CARE/MBL",
      "jobTitle": "Tech Docmatn Cntrl, Spec",
      "custPayGradeLevel": 10,
      "custTargetTab": "",
      "curSalary": 73199.98,
      "custCurHrlySalary": 35.1923,
      "payGuideMid": 95160,
      "curRatio": 76.92,
      "custPerformanceZone": "6",
      "custPDScore": "C+/E",
      "compaRatioRanges": "",
      "meritGuideline": 4,
      "merit": 7320,
      "merit_Percentage": 10,
      "commentformerit": "Aracely Diez commented on February 19, 2025 11:44 PM: Low CR",
      "custExceptionCode": "A2:Incr > Model - Explain",
      "lumpSum": 0,
      "lumpSum_Percentage": 0,
      "finSalary": 80519.98,
      "compaRatio": 84.62,
      "custMeritExcepReqAmt": 0,
      "custMeritExcepReqPct": 0,
      "custfinSalaryExcepReq": 73199.98,
      "custCompaRatioExcepReq": 76.92,
      "custMeritExcepReqComment": "",
      "salaryNote": "",
      "payAdjustmentAmount": 0,
      "payAdjustmentAmountPer": 0,
      "payAdjustmentFinalPay": 0,
      "status": "S"
    }
  ]
}


### GET CRVException
GET {{svc}}/CRVException?$filter=path eq '/FEED/DOWNLOAD/WFA/Compensation_Data_Modeling/CRVExceptionListSF/'
Content-Type: application/json
 

### READ from DB
GET http://localhost:4004/odata/v4/zhr-comp-cap-crvexcep-srv/readCompensationRatioMaster

### READ from DB

GET {{svc}}/readTargets
Content-Type: application/json

{
  "year": 2025
}

### READ from Totals

GET {{svc}}/readTargetTotal
Content-Type: application/json

{ 
  "year" : 2025,
  "TargetTabName" : "Target-3"
}

### READ from Totals

GET {{svc}}/readcreatemodel
Content-Type: application/json

{ 
  "year" : 2025
}

### Post Number Range

POST {{svc}}/createnumberRange
Content-Type: application/json

{ 
  "Modeltype" : "CRV",
  "year" : 2025
  
}

### READ CRV Model
GET {{svc}}/crvModelsLaunch?$filter= year eq 2025
Content-Type: application/json

### READ CRV Approved by
GET {{svc}}/readApprovedby
Content-Type: application/json

### READ CRV Created by
GET {{svc}}/readCreatedby
Content-Type: application/json

### READ CRV Status

GET {{svc}}/readStatus
Content-Type: application/json

### READ Targets
GET {{svc}}/readTargetMaster
Content-Type: application/json

### POST CRV Model
POST {{svc}}/crvModelsLaunch
Content-Type: application/json

{
  "year" : 2025,
  "model_Id" : "HR001",
  "targetTab": "TargetTab1",
  "modelOption":"3",
  "totalsalary":"3000003",
  "pool":"100034",
  "pool_available":"3000045",
  "totalDistributed":"300000",
  "totalDistrubuted_Percentage":"2",
  "remainingPool":"2343425",
  "remainingPool_Percentage":"2",
  "remainingPoolbalance":"100000",
  "createdname":"venkata Gedala",
  "approvedby" : "saiprasoona.moolpuru@sce.com",
  "approvedon" : "2025-08-07",
  "approvedname": "Sai Prasoona",
  "approvedcomments":"Approved the Model 3",
  "publishedon":"2025-08-08",
  "publishedname": "Raghu Nimmalapudi",
  "publishedby":"raghuram.nimmalapudi@sce.com",
  "publishedcomments": "Published the Model 3",
  "status": "P"
}

###POST TARGET Tabs
POST {{svc}}/CRVTargets
Content-Type: application/json

{
  "year":2025,
  "TargetTabName":"Target1",
  "Modeltype":"CRV",
  "custBusUnit":"Business4",
  "changedStatus":"X",
  "fieldUsage":"A"
}

### POST Divisions

POST {{svc}}/CRVDivisions 
Content-Type: application/json

{
  "year":2025,
  "TargetTabName":"Target1",
  "Modeltype":"CRV",
  "custBusUnit":"Business4",
  "custDivision":"Division6"
}

### Post Targets

POST {{svc}}/createupsertTargetTabs
Content-Type: application/json

{
  "nestedpayload": {
      "year": 2025,
      "Modeltype": "CRV",
      "TargetTabName": "Target10",
      "custBusUnit": "Business50",
      "changedStatus": "X",
      "fieldUsage": "A",
      "to_divisions": [
        {
          "custDivision": "Division50"
        },
        {
          "custDivision": "Division11"
        }
      ]
  }
}
